"resid")
abline(0,0, col="red")
par(mfrow=c(2,2))
mmp(rline2,opioid$Home.Price)
mmp(rline2,opioid$Median.Income)
mmp(rline_transform,opioid$Home.Price)
mmp(rline_transform,opioid$Median.Income)
influencePlot(rline2)
outlierTest(rline2)
influenceIndexPlot(rline2)
plot(rline2,which=3:4)
influencePlot(rline_transform)
outlierTest(rline_transform)
influenceIndexPlot(rline_transform)
plot(rline_transform,which=3:4)
opioid_outliers<-opioid[-c(12,14,18),]
rline_outliers<-lm(formula = Death.Rate ~ Median.Income+Home.Price, data=opioid_outliers)
plot(rline_outliers,which = 1:4)
mmp(rline_outliers,opioid_outliers$Home.Price)
mmp(rline_outliers,opioid_outliers$Median.Income)
shapiro.test(rline_outliers$residuals)
ncvTest(rline_outliers)
e3=residuals(rline_outliers)
plot(opioid_outliers$Median.Income, e3, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers$Home.Price, e3, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Median.Income)
plot(rline_outliers_transform, which=1:4)
shapiro.test(rline_outliers_transform$residuals)
ncvTest(rline_outliers_transform)
e4=residuals(rline_outliers_transform)
plot(opioid_outliers_transform$Median.Income, e4, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers_transform$Home.Price, e4, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline)
rline2<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price)
summary(rline2)
rline_transform_full<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline_transform_full)
rline_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price)
summary(rline_transform)
rline_outliers_transform_full<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Unemployment+opioid_outliers_transform$Poverty+opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price+opioid_outliers_transform$no.high.school)
summary(rline_outliers_transform_full)
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
summary(rline_outliers_transform)
rline_outliers_full<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Unemployment+opioid_outliers$Poverty+opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$no.high.school)
summary(rline_outliers_full)
rline_outliers<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price)
summary(rline_outliers)
rinteraction_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price+opioid$Median.Income*opioid$Home.Price)
anova(rline_transform, rinteraction_transform)
rinteraction_outliers<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$Median.Income*opioid_outliers$Home.Price)
anova(rline_outliers, rinteraction_outliers)
rinteraction_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price+opioid$Median.Income*opioid$Home.Price)
anova(rline_transform, rinteraction_transform)
rinteraction_outliers<-lm(formula = sqrt(opioid_outliers$Death.Rate) ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$Median.Income*opioid_outliers$Home.Price)
anova(rline_outliers, rinteraction_outliers)
rinteraction_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price+opioid$Median.Income*opioid$Home.Price)
anova(rline_transform, rinteraction_transform)
rinteraction_outliers<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$Median.Income*opioid_outliers$Home.Price)
anova(rline_outliers, rinteraction_outliers)
library(MASS)
#fit1 <- lm(y ~ ., data)
#fit2 <- lm(y ~ 1, data)
additive_null=lm(Death.Rate~1, data=opioid_outliers)
stepAIC(rline_outliers,direction="backward")
stepAIC(additive_null,direction="forward",scope=list(upper=rline_outliers,lower=additive_null))
stepAIC(additive_null,direction="both",scope=list(upper=rline_outliers,lower=additive_null))
additive_null=lm(sqrt(Death.Rate)~1, data=opioid)
stepAIC(rline_transform,direction="backward")
stepAIC(additive_null,direction="forward",scope=list(upper=rline_transform,lower=additive_null))
stepAIC(additive_null,direction="both",scope=list(upper=rline_transform,lower=additive_null))
library(plotly)
library(reshape2)
#Setup Axis
axis_x <- seq(min(opioid_outliers$Median.Income), max(opioid_outliers$Median.Income), by = 1000)
axis_y <- seq(min(opioid_outliers$Home.Price), max(opioid_outliers$Home.Price), by = 10000)
#Sample points
lm_surface <- expand.grid(Median.Income = axis_x,Home.Price = axis_y, KEEP.OUT.ATTRS = F)
lm_surface$Death.Rate <- predict.lm(rline_outliers, newdata = lm_surface)
library(plotly)
library(reshape2)
axix-1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
library(plotly)
library(reshape2)
axis-1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis2<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
library(plotly)
library(reshape2)
axis1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis2<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
lm<-expand.grid(Median.Income=axis1, Home.Price=axis2, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata = lm)
str(lm_surface)
View(lm_surface)
library(plotly)
library(reshape2)
#Setup Axis
axis_x <- seq(min(opioid_outliers$Median.Income), max(opioid_outliers$Median.Income), by = 1000)
axis_y <- seq(min(opioid_outliers$Home.Price), max(opioid_outliers$Home.Price), by = 10000)
#Sample points
lm_surface <- expand.grid(Median.Income = axis_x,Home.Price = axis_y, KEEP.OUT.ATTRS = F)
View(lm_surface)
lm_surface$Death.Rate <- predict.lm(rline_outliers, newdata = lm_surface)
library(plotly)
library(reshape2)
#Setup Axis
axis_x <- seq(min(opioid_outliers$Median.Income), max(opioid_outliers$Median.Income), by = 1000)
axis_y <- seq(min(opioid_outliers$Home.Price), max(opioid_outliers$Home.Price), by = 10000)
#Sample points
lm_surface <- expand.grid(Median.Income = axis_x,Home.Price = axis_y, KEEP.OUT.ATTRS = F)
#View(lm_surface)
lm_surface$Death.Rate <- predict.lm(rline_outliers, newdata = lm_surface)
library(plotly)
library(reshape2)
axis1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis2<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
lm<-expand.grid(Median.Income=axis1, Home.Price=axis2, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata = lm)
str(opioid)
library(plotly)
library(reshape2)
axis1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis2<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
lm<-expand.grid(Median.Income=axis1, Home.Price=axis2, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata = lm)
library(plotly)
library(reshape2)
axis1<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
axis2<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
lm<-expand.grid(Median.Income=axis1, Home.Price=axis2, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata = data.frame(lm))
library(plotly)
library(reshape2)
Median.Income<-seq(min(opioid_outliers_transform$Median.Income), max(opioid_outliers_transform$Median.Income), by=1000)
Home.Price<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
lm<-expand.grid(Median.Income=Median.Income, Home.Price=Home.Price, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata = lm)
library(plotly)
library(reshape2)
Median.Income<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
Home.Price<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
newdata<-expand.grid(Median.Income=Median.Income, Home.Price=Home.Price, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata)
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
library(plotly)
library(reshape2)
Median.Income<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
Home.Price<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
newdata<-expand.grid(Median.Income=Median.Income, Home.Price=Home.Price, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, data=newdata)
library(plotly)
library(reshape2)
Median.Income<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
Home.Price<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
data<-expand.grid(Median.Income=Median.Income, Home.Price=Home.Price, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict.lm(rline_outliers_transform, newdata=data)
library(plotly)
library(reshape2)
a<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
b<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
data<-expand.grid(Median.Income=a, Home.Price=b, KEEP.OUT.ATTRS = F)
library(plotly)
library(reshape2)
a<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
b<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
data<-expand.grid(Median.Income=a, Home.Price=b, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict(rline_outliers_transform, newdata=data)
opioid = read.table("LRdata.csv", sep=',', header = TRUE)
#install.packages('car')
#install.packages('psych')
#install.packages('MASS')
library(MASS)
library(car)
library(psych)
str(opioid)
pairs(~Death.Rate+Unemployment+Poverty+Median.Income+Home.Price+no.high.school,data=opioid, main="Simple Scatterplot Matrix")
scatterplotMatrix(~Death.Rate+Unemployment+Poverty+Median.Income+Home.Price+no.high.school,data=opioid, smooth = FALSE, ellipse="FALSE", main="Simple Scatterplot Matrix")
cor(opioid[,2:7])
corr.test(opioid[,2:7], y = NULL, use ="pairwise",method="pearson",adjust="holm",alpha=.05)
par(mfrow=c(3,2))
hist(opioid$Unemployment)
hist(opioid$Poverty)
hist(opioid$Median.Income)
hist(opioid$Home.Price)
hist(opioid$no.high.school)
library(corrplot)
M <- cor(opioid[,2:7])
corrplot(M,method="number")
corrplot(M,method="pie")
corrplot.mixed(M)
# matrix of the p-value of the correlation
p.mat <- cor.mtest(opioid[,2:7], conf.level=0.95)
corrplot(M, p.mat = p.mat$p, sig.level=0.05, insig="p-value")
rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline)
rline2<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price)
summary(rline2)
plot(rline2,which=1:4)
shapiro.test(rline2$residuals)
ncvTest(rline2)
e=residuals(rline2)
plot(opioid$Unemployment, e, xlab = "unemployment", ylab =
"resid")
abline(0,0, col="red")
plot(opioid$Poverty, e, xlab = "poverty", ylab =
"resid")
abline(0,0, col="red")
plot(opioid$Median.Income, e, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid$Home.Price, e, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
opioid_boxcox<-opioid
opioid_boxcox[,2][opioid_boxcox[,2] == 0] <- 0.0001
opioid_boxcox
rline_boxcox<-lm(formula = opioid_boxcox$Death.Rate~opioid_boxcox$Median.Income+opioid_boxcox$Home.Price)
boxcox(rline_boxcox)
rline_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price)
plot(rline_transform, which=1:4)
shapiro.test(rline_transform$residuals)
ncvTest(rline_transform)
e2=residuals(rline_transform)
plot(opioid$Median.Income, e2, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid$Home.Price, e2, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
par(mfrow=c(2,2))
mmp(rline2,opioid$Home.Price)
mmp(rline2,opioid$Median.Income)
mmp(rline_transform,opioid$Home.Price)
mmp(rline_transform,opioid$Median.Income)
influencePlot(rline2)
outlierTest(rline2)
influenceIndexPlot(rline2)
plot(rline2,which=3:4)
influencePlot(rline_transform)
outlierTest(rline_transform)
influenceIndexPlot(rline_transform)
plot(rline_transform,which=3:4)
opioid_outliers<-opioid[-c(12,14,18),]
rline_outliers<-lm(formula = Death.Rate ~ Median.Income+Home.Price, data=opioid_outliers)
plot(rline_outliers,which = 1:4)
mmp(rline_outliers,opioid_outliers$Home.Price)
mmp(rline_outliers,opioid_outliers$Median.Income)
shapiro.test(rline_outliers$residuals)
ncvTest(rline_outliers)
e3=residuals(rline_outliers)
plot(opioid_outliers$Median.Income, e3, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers$Home.Price, e3, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Median.Income)
plot(rline_outliers_transform, which=1:4)
shapiro.test(rline_outliers_transform$residuals)
ncvTest(rline_outliers_transform)
e4=residuals(rline_outliers_transform)
plot(opioid_outliers_transform$Median.Income, e4, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers_transform$Home.Price, e4, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline)
rline2<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price)
summary(rline2)
rline_transform_full<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline_transform_full)
rline_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price)
summary(rline_transform)
rline_outliers_transform_full<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Unemployment+opioid_outliers_transform$Poverty+opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price+opioid_outliers_transform$no.high.school)
summary(rline_outliers_transform_full)
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
summary(rline_outliers_transform)
rline_outliers_full<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Unemployment+opioid_outliers$Poverty+opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$no.high.school)
summary(rline_outliers_full)
rline_outliers<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price)
summary(rline_outliers)
rinteraction_transform<-lm(formula = sqrt(opioid$Death.Rate) ~ opioid$Median.Income+opioid$Home.Price+opioid$Median.Income*opioid$Home.Price)
anova(rline_transform, rinteraction_transform)
rinteraction_outliers<-lm(formula = opioid_outliers$Death.Rate ~ opioid_outliers$Median.Income+opioid_outliers$Home.Price+opioid_outliers$Median.Income*opioid_outliers$Home.Price)
anova(rline_outliers, rinteraction_outliers)
library(MASS)
#fit1 <- lm(y ~ ., data)
#fit2 <- lm(y ~ 1, data)
additive_null=lm(Death.Rate~1, data=opioid_outliers)
stepAIC(rline_outliers,direction="backward")
stepAIC(additive_null,direction="forward",scope=list(upper=rline_outliers,lower=additive_null))
stepAIC(additive_null,direction="both",scope=list(upper=rline_outliers,lower=additive_null))
additive_null=lm(sqrt(Death.Rate)~1, data=opioid)
stepAIC(rline_transform,direction="backward")
stepAIC(additive_null,direction="forward",scope=list(upper=rline_transform,lower=additive_null))
stepAIC(additive_null,direction="both",scope=list(upper=rline_transform,lower=additive_null))
library(plotly)
library(reshape2)
#Setup Axis
axis_x <- seq(min(opioid_outliers$Median.Income), max(opioid_outliers$Median.Income), by = 1000)
axis_y <- seq(min(opioid_outliers$Home.Price), max(opioid_outliers$Home.Price), by = 10000)
#Sample points
lm_surface <- expand.grid(Median.Income = axis_x,Home.Price = axis_y, KEEP.OUT.ATTRS = F)
#View(lm_surface)
lm_surface$Death.Rate <- predict.lm(rline_outliers, newdata = lm_surface)
#rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
#summary(rline)
rline0<-lm(formulaopioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
#rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
#summary(rline)
rline0<-lm(formula=opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline0)
rline2<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price)
summary(rline2)
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Median.Income)
plot(rline_outliers_transform, which=1:4)
shapiro.test(rline_outliers_transform$residuals)
ncvTest(rline_outliers_transform)
e4=residuals(rline_outliers_transform)
plot(opioid_outliers_transform$Median.Income, e4, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers_transform$Home.Price, e4, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
summary(rline_outliers_transform)
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
summary(rline_outliers_transform)
mmp(rline_outliers_transform,opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Median.Income)
plot(rline_outliers_transform, which=1:4)
shapiro.test(rline_outliers_transform$residuals)
ncvTest(rline_outliers_transform)
e4=residuals(rline_outliers_transform)
plot(opioid_outliers_transform$Median.Income, e4, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers_transform$Home.Price, e4, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
null=lm(Death.Rate~1, data=opioid)
summary(null)
full = lm(Death.Rate~.-County, data=opioid)
summary(full)
step(null, scope=list(lower=null, upper=full),direction="forward")
library(plotly)
library(reshape2)
a<-seq(min(opioid_outliers_transform$Median.Income),max(opioid_outliers_transform$Median.Income), by=1000)
b<-seq(min(opioid_outliers_transform$Home.Price), max(opioid_outliers_transform$Home.Price), by=10000)
data<-expand.grid(Median.Income=a, Home.Price=b, KEEP.OUT.ATTRS = F)
lm$Death.Rate<-predict(rline_outliers_transform, newdata=data)
library(plotly)
library(reshape2)
rline_outliers_transform_v2_graph<-lm(formula = sqrt(Death.Rate) ~ Median.Income+Home.Price, data=opioid_outliers_transform_v2)
library(plotly)
library(reshape2)
rline_outliers_transform_v2_graph<-lm(formula = sqrt(Death.Rate) ~ Median.Income+Home.Price, data=opioid_outliers_transform_v2)
library(plotly)
library(reshape2)
opioid_outliers_transform_v2<-opioid[-c(22,25),]
rline_outliers_transform_v2_graph<-lm(formula = sqrt(Death.Rate) ~ Median.Income+Home.Price, data=opioid_outliers_transform_v2)
#Setup Axis
axis_x2 <- seq(min(opioid_outliers_transform_v2$Median.Income), max(opioid_outliers_transform_v2$Median.Income), by = 1000)
axis_y2 <- seq(min(opioid_outliers_transform_v2$Home.Price), max(opioid_outliers_transform_v2$Home.Price), by = 10000)
#Sample points
lm_surface2 <- expand.grid(Median.Income = axis_x2,Home.Price = axis_y2,KEEP.OUT.ATTRS = F)
lm_surface2$Death.Rate <- predict.lm(rline_outliers_transform_v2_graph, newdata = lm_surface2)
lm_surface2 <- acast(lm_surface2, Home.Price ~ Median.Income, value.var = "Death.Rate") #y ~ x
#scatterplot of data
#hcolors=c("red","blue","green")[my_df$Species]
dot_plot2 <- plot_ly(opioid_outliers_transform_v2,
x = ~Median.Income,
y = ~Home.Price,
z = ~Death.Rate,
type = "scatter3d")
#adding surface to plot
outlier_plot2 <- add_trace(p = dot_plot2,
z = lm_surface2,
x = axis_x2,
y = axis_y2,
type = "surface")
outlier_plot2
install.packages("reshape2")
install.packages("plotly")
install.packages("plotly")
install.packages("plotly")
library(plotly)
library(reshape2)
opioid_outliers_transform_v2<-opioid[-c(22,25),]
rline_outliers_transform_v2_graph<-lm(formula = sqrt(Death.Rate) ~ Median.Income+Home.Price, data=opioid_outliers_transform_v2)
#Setup Axis
axis_x2 <- seq(min(opioid_outliers_transform_v2$Median.Income), max(opioid_outliers_transform_v2$Median.Income), by = 1000)
axis_y2 <- seq(min(opioid_outliers_transform_v2$Home.Price), max(opioid_outliers_transform_v2$Home.Price), by = 10000)
#Sample points
lm_surface2 <- expand.grid(Median.Income = axis_x2,Home.Price = axis_y2,KEEP.OUT.ATTRS = F)
lm_surface2$Death.Rate <- predict.lm(rline_outliers_transform_v2_graph, newdata = lm_surface2)
lm_surface2 <- acast(lm_surface2, Home.Price ~ Median.Income, value.var = "Death.Rate") #y ~ x
#scatterplot of data
#hcolors=c("red","blue","green")[my_df$Species]
dot_plot2 <- plot_ly(opioid_outliers_transform_v2,
x = ~Median.Income,
y = ~Home.Price,
z = ~Death.Rate,
type = "scatter3d")
#adding surface to plot
outlier_plot2 <- add_trace(p = dot_plot2,
z = lm_surface2,
x = axis_x2,
y = axis_y2,
type = "surface")
outlier_plot2
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages(c("C50", "callr", "caret", "Cubist", "CVST", "data.table", "dplyr", "h2o", "htmlTable", "labelled", "miniUI", "modelr", "openxlsx", "pillar", "processx", "quantreg", "Rcpp", "rJava", "rpart.plot", "RWeka", "shiny", "stringi", "stringr", "tidyr", "utf8"))
install.packages(c("C50", "callr", "caret", "Cubist", "CVST", "data.table", "dplyr", "h2o", "htmlTable", "labelled", "miniUI", "modelr", "openxlsx", "pillar", "processx", "quantreg", "Rcpp", "rJava", "rpart.plot", "RWeka", "shiny", "stringi", "stringr", "tidyr", "utf8"))
install.packages(c("C50", "callr", "caret", "Cubist", "CVST", "data.table", "dplyr", "h2o", "htmlTable", "labelled", "miniUI", "modelr", "openxlsx", "pillar", "processx", "quantreg", "Rcpp", "rJava", "rpart.plot", "RWeka", "shiny", "stringi", "stringr", "tidyr", "utf8"))
install.packages(c("C50", "callr", "caret", "Cubist", "CVST", "data.table", "dplyr", "h2o", "htmlTable", "labelled", "miniUI", "modelr", "openxlsx", "pillar", "processx", "quantreg", "Rcpp", "rJava", "rpart.plot", "RWeka", "shiny", "stringi", "stringr", "tidyr", "utf8"))
install.packages(c("C50", "callr", "caret", "Cubist", "CVST", "data.table", "dplyr", "h2o", "htmlTable", "labelled", "miniUI", "modelr", "openxlsx", "pillar", "processx", "quantreg", "Rcpp", "rJava", "rpart.plot", "RWeka", "shiny", "stringi", "stringr", "tidyr", "utf8"))
```{r}
library(corrplot)
M <- cor(opioid[,2:7])
corrplot(M,method="number")
corrplot(M,method="pie")
corrplot.mixed(M)
# matrix of the p-value of the correlation
p.mat <- cor.mtest(opioid[,2:7], conf.level=0.95)
corrplot(M, p.mat = p.mat$p, sig.level=0.05, insig="p-value")
library(corrplot)
M <- cor(opioid[,2:7])
corrplot(M,method="number")
corrplot(M,method="pie")
corrplot.mixed(M)
opioid = read.table("LRdata.csv", sep=',', header = TRUE)
#install.packages('car')
#install.packages('psych')
#install.packages('MASS')
library(MASS)
library(car)
library(psych)
str(opioid)
pairs(~Death.Rate+Unemployment+Poverty+Median.Income+Home.Price+no.high.school,data=opioid, main="Simple Scatterplot Matrix")
scatterplotMatrix(~Death.Rate+Unemployment+Poverty+Median.Income+Home.Price+no.high.school,data=opioid, smooth = FALSE, ellipse="FALSE", main="Simple Scatterplot Matrix")
cor(opioid[,2:7])
corr.test(opioid[,2:7], y = NULL, use ="pairwise",method="pearson",adjust="holm",alpha=.05)
par(mfrow=c(3,2))
hist(opioid$Unemployment)
hist(opioid$Poverty)
hist(opioid$Median.Income)
hist(opioid$Home.Price)
hist(opioid$no.high.school)
library(corrplot)
M <- cor(opioid[,2:7])
corrplot(M,method="number")
corrplot(M,method="pie")
corrplot.mixed(M)
# matrix of the p-value of the correlation
p.mat <- cor.mtest(opioid[,2:7], conf.level=0.95)
corrplot(M, p.mat = p.mat$p, sig.level=0.05, insig="p-value")
null=lm(Death.Rate~1, data=opioid)
summary(null)
full = lm(Death.Rate~.-County, data=opioid)
summary(full)
step(null, scope=list(lower=null, upper=full),direction="forward")
#rline<-lm(formula = opioid$Death.Rate ~ opioid$Unemployment+opioid$Poverty+opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
#summary(rline)
rline0<-lm(formula=opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price+opioid$no.high.school)
summary(rline0)
rline2<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price)
summary(rline2)
rline3<-lm(formula = opioid$Death.Rate ~ opioid$Median.Income+opioid$Home.Price+opioid$Home.Price*opioid$Median.Income)
summary(rline3)
opioid_outliers_transform<-opioid[-c(22,25),]
rline_outliers_transform<-lm(formula = sqrt(opioid_outliers_transform$Death.Rate) ~ opioid_outliers_transform$Median.Income+opioid_outliers_transform$Home.Price)
summary(rline_outliers_transform)
mmp(rline_outliers_transform,opioid_outliers_transform$Home.Price)
mmp(rline_outliers_transform,opioid_outliers_transform$Median.Income)
plot(rline_outliers_transform, which=1:4)
shapiro.test(rline_outliers_transform$residuals)
ncvTest(rline_outliers_transform)
e4=residuals(rline_outliers_transform)
plot(opioid_outliers_transform$Median.Income, e4, xlab = "median income", ylab =
"resid")
abline(0,0, col="red")
plot(opioid_outliers_transform$Home.Price, e4, xlab = "home price", ylab =
"resid")
abline(0,0, col="red")
